

#include "serialposix.h"

void test()
{
	printf("BROKEN LINK\n");
}

int main(int argc,char ** argv){

	int	fd = open_serial(argv[1],9600);

	if(fd < 0)
	{
		printf("file descriptor %d \n",fd); 
		exit(-2);
	}

	 char test[1024];
	 char test2[1024];
	printf("File DS :  %d\n",fd);

	register_SerialBrokenLink(test);
	
	while(1){

	     memset(test2,0,sizeof(test2));

	if(serialport_read(fd,&test2[0]) > 0){
		
		printf("<%s> \n",test2);
	}
	
	
	}
	close_serial(fd);


	return 0;
}
